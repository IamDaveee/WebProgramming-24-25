<!DOCTYPE html>
<html lang="hu">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    <title>Űrlap - regisztráció, jelszóerősség</title>
    <style>
        .material-symbols-outlined { 
            vertical-align: middle; position: relative; left: -2rem;
            cursor: pointer;
        }
        input { padding: .25rem; }
        .required::placeholder { color: red; }

        input[type=range]{
            width: 90%;
        }
        progress{
            width: 90%;
        }
    </style>
</head>

<body>
    <h1>Űrlap - regisztráció, jelszóerősség</h1>
    <form action="#" name="reg" id="form">
        <fieldset>
            <legend><h2>Regisztáció</h2></legend>
            <!-- input type="checkbox" name="" id="" readonly disabled tabindex="-1" -->
            <input type="text" name="name" id="name" placeholder="Neved">
            <p><input class="required" type="email" name="email" id="email" placeholder="e-mail cím" required></p>
            <p><input type="password" class="required" name="psw" id="psw" placeholder="jelszó" required>
                <span class="material-symbols-outlined" id="eye">visibility</span>
            </p>
            <p>Jelszó erősség:<br>
                Hossz: <input type="checkbox" name="hossz" id="hossz" readonly tabindex="-1"> |
                kisbetű: <input type="checkbox" name="kisbetu" id="kisbetu" readonly tabindex="-1"> |
                nagybetű: <input type="checkbox" name="nagybetu" id="nagybetu" readonly tabindex="-1"> |
                szám: <input type="checkbox" name="szam" id="szam" readonly tabindex="-1">
            </p>
            <p style="text-align: center;">
                <input type="range" name="jelszoerosseg" max="4" min="0" value="0"><br>
                <progress id="jelszoerosseg" min="0" max="4" value="0"></progress>
            </p>

            <label for="elfogad"><input type="checkbox" name="elfogad" id="elfogad"> Elfogadom a szabályzatot...</label>
            <p>
                <button type="submit" name="login">Belépés</button>
                <button type="submit" name="registration">Regisztáció</button>
                <button type="reset" name="reset">Visszaállít</button>
            </p>
        </fieldset>
    </form>

    <script>

        const form = document.reg
        //-----------------------
        /*
        form.psw.required=false;
        form.elfogad.checked=true
        form.psw.onmousehover =()=>form.psw.type="text"
        form.psw.onmouseout =()=>form.psw.type="password"
        */
        //-----------------------

        let visible=false
        document.getElementById("eye").onclick = () => {
            if(!visible){
                form.psw.type="text"
                document.getElementById("eye").innerText="visibility_off"
            }
            else{
                form.psw.type="password"
                document.getElementById("eye").innerText="visibility"
            }
            //console.log(visible)
            visible=!visible
        }

        function login() {
            document.getElementById("form").innerHTML=`Üdvözlünk újra <b>${(form.name.value)?form.name.value:form.email.value}</b>`
            form.reset()
        }
        function registration() {
            if (!form.elfogad.checked) {
                    alert("Fogadja el a szerződést")
                    form.elfogad.select()
                }
            else{
                
                if (jelszoerosseg!=4) {
                    alert("A jelszó nem elég erős")
                    form.psw.focus()
                }
                else{
                    let confirmpsw=prompt("Erősítse meg a jelszót: ")
                    if (confirmpsw==form.psw.value) {
                        alert("Sikeres Regisztráció")
                        document.getElementById("form").innerHTML = `${(form.name.value)?"Sikeres regisztráció "+"<b>"+form.name.value+"</b>"+" névre, "+"<b>"+form.email.value+"</b>"+" email címre":"Sikeres regisztráció "+"<b>"+form.email.value+"</b>"+" email címre"}`
                        form.reset()
                    }
                    else{
                        alert("A jelszavak nem egyeznek")
                        form.psw.focus()
                    }
                }
            }
        }

        form.onsubmit=(event)=>{
            event.preventDefault()
            if (event.submitter.name=="login") {
                login()
            }
            else {
                registration()
            }
        }

        function Jelszovizsgalat(minta, checkboxName, uzenet) {
            if (minta.test(form.psw.value)) {
                checkboxName.checked=true
                jelszoerosseg++
                uzenet=""
            }
            else{
                checkboxName.checked=false
                //jelszavak+=üzenet
            }
            return uzenet
        }
        let jelszavak="";
        
        let jelszoerosseg
        form.psw.oninput = ()=>{
            jelszoerosseg=0
            jelszavak="";
            if (form.psw.value.length>3) {
                form.hossz.checked=true
                jelszoerosseg++
            }
            else{
                form.hossz.checked=false
                jelszavak+="Rövid\n"
            }


            jelszavak+= Jelszovizsgalat(/[0-9]/, form.szam, "Nem tartalmaz számot\n")
            /*
            if (/[0-9]/.test(form.psw.value)) {
                form.szam.checked=true
                jelszoerosseg++
            }
            else{
                form.szam.checked=false
                jelszavak+="Nem tartalmaz számot\n"
            }
            */
            jelszavak+= Jelszovizsgalat(/[a-z]/,form.kisbetu, "Nem tartalmaz kisbetűt\n")
            /*

            if (/[a-z]/.test(form.psw.value)) {
                form.kisbetu.checked=true
                jelszoerosseg++
            }
            else{
                form.kisbetu.checked=false
                jelszavak+="Nem tartalmaz kisbetűt\n"
            }

            */

            jelszavak+= Jelszovizsgalat(/[A-Z]/, form.nagybetu, "Nem tartalmaz nagybetűt\n")
            /*
            if (/[A-Z]/.test(form.psw.value)) {
                form.nagybetu.checked=true
                jelszoerosseg++
            }
            else{
                form.nagybetu.checked=false
                jelszavak+="Nem tartalmaz nagybetűt\n"
            }
            */
            //alternatív
                //jelszoerosseg=form.hossz.checked+form.szam.checked+form.kisbetu.checked+form.nagybetu.checked
            //

            form.jelszoerosseg.value=jelszoerosseg
            form.jelszoerosseg.title="Jelszóerősség 1-4: "+jelszoerosseg + "\n"+jelszavak
            
            //progressba
            document.getElementById("jelszoerosseg").value=jelszoerosseg
            document.getElementById("jelszoerosseg").title="Jelszóerősség 1-4: "+jelszoerosseg + "\n"+jelszavak
            //
        }



    /* jelszóerősség 
        - hossz
        Regular expression https://www.w3schools.com/jsref/jsref_obj_regexp.asp
        - kisbetű
        - nagybetű
        - szám
        visszajelzés szín, jelölönégyzetek: tiltott | csakolvasható 
    */
    </script>
</body>

</html>